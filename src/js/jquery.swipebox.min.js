(function(b,a,c,d){c.swipebox=function(g,q){var j={useCSS:true,initialIndexOnArray:0,hideBarsDelay:3000,videoMaxWidth:1140,vimeoColor:"CCCCCC",beforeOpen:null,afterClose:null},n=this,e=[],h=g.selector,p=c(h),k=a.createTouch!==d||("ontouchstart" in b)||("onmsgesturechange" in b)||navigator.msMaxTouchPoints,l=!!(b.SVGSVGElement),f=b.innerWidth?b.innerWidth:c(b).width(),i=b.innerHeight?b.innerHeight:c(b).height(),m='<div id="swipebox-overlay">                <div id="swipebox-slider"></div>                <div id="swipebox-caption"></div>                <div id="swipebox-action">                    <a id="swipebox-close"></a>                    <a id="swipebox-prev"></a>                    <a id="swipebox-next"></a>                </div>        </div>';n.settings={};n.init=function(){n.settings=c.extend({},j,q);if(c.isArray(g)){e=g;o.target=c(b);o.init(n.settings.initialIndexOnArray)}else{p.click(function(t){e=[];var r,s,u;if(!u){s="rel";u=c(this).attr(s)}if(u&&u!==""&&u!=="nofollow"){$elem=p.filter("["+s+'="'+u+'"]')}else{$elem=c(h)}$elem.each(function(){var w=null,v=null;if(c(this).attr("title")){w=c(this).attr("title")}if(c(this).attr("href")){v=c(this).attr("href")}e.push({href:v,title:w})});r=$elem.index(c(this));t.preventDefault();t.stopPropagation();o.target=c(t.target);o.init(r)})}};n.refresh=function(){if(!c.isArray(g)){o.destroy();$elem=c(h);o.actions()}};var o={init:function(r){if(n.settings.beforeOpen){n.settings.beforeOpen()}this.target.trigger("swipebox-start");c.swipebox.isOpen=true;this.build();this.openSlide(r);this.openMedia(r);this.setSlide(r,true);this.preloadMedia(r+1);this.preloadMedia(r-1)},build:function(){var s=this;c("body").append(m);if(s.doCssTrans()){c("#swipebox-slider").css({"-webkit-transition":"left 0.4s ease","-moz-transition":"left 0.4s ease","-o-transition":"left 0.4s ease","-khtml-transition":"left 0.4s ease",transition:"left 0.4s ease"});c("#swipebox-overlay").css({"-webkit-transition":"opacity 1s ease","-moz-transition":"opacity 1s ease","-o-transition":"opacity 1s ease","-khtml-transition":"opacity 1s ease",transition:"opacity 1s ease"});c("#swipebox-action, #swipebox-caption").css({"-webkit-transition":"0.5s","-moz-transition":"0.5s","-o-transition":"0.5s","-khtml-transition":"0.5s",transition:"0.5s"})}if(l){var r=c("#swipebox-action #swipebox-close").css("background-image");r=r.replace("png","svg");c("#swipebox-action #swipebox-prev,#swipebox-action #swipebox-next,#swipebox-action #swipebox-close").css({"background-image":r})}c.each(e,function(){c("#swipebox-slider").append('<div class="slide"></div>')});s.setDim();s.actions();s.keyboard();s.gesture();s.animBars();s.resize()},setDim:function(){var t,r,s={};if("onorientationchange" in b){b.addEventListener("orientationchange",function(){if(b.orientation===0){t=f;r=i}else{if(b.orientation==90||b.orientation==-90){t=i;r=f}}},false)}else{t=b.innerWidth?b.innerWidth:c(b).width();r=b.innerHeight?b.innerHeight:c(b).height()}s={width:t,height:r};c("#swipebox-overlay").css(s)},resize:function(){var r=this;c(b).resize(function(){r.setDim()}).resize()},supportTransition:function(){var s="transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" ");for(var r=0;r<s.length;r++){if(a.createElement("div").style[s[r]]!==d){return s[r]}}return false},doCssTrans:function(){if(n.settings.useCSS&&this.supportTransition()){return true}},gesture:function(){if(k){var v=this,w=null,u=10,t={},r={};var s=c("#swipebox-caption, #swipebox-action");s.addClass("visible-bars");v.setTimeout();c("body").bind("touchstart",function(x){c(this).addClass("touching");r=x.originalEvent.targetTouches[0];t.pageX=x.originalEvent.targetTouches[0].pageX;c(".touching").bind("touchmove",function(y){y.preventDefault();y.stopPropagation();r=y.originalEvent.targetTouches[0]});return false}).bind("touchend",function(x){x.preventDefault();x.stopPropagation();w=r.pageX-t.pageX;if(w>=u){v.getPrev()}else{if(w<=-u){v.getNext()}else{if(!s.hasClass("visible-bars")){v.showBars();v.setTimeout()}else{v.clearTimeout();v.hideBars()}}}c(".touching").off("touchmove").removeClass("touching")})}},setTimeout:function(){if(n.settings.hideBarsDelay>0){var r=this;r.clearTimeout();r.timeout=b.setTimeout(function(){r.hideBars()},n.settings.hideBarsDelay)}},clearTimeout:function(){b.clearTimeout(this.timeout);this.timeout=null},showBars:function(){var r=c("#swipebox-caption, #swipebox-action");if(this.doCssTrans()){r.addClass("visible-bars")}else{c("#swipebox-caption").animate({top:0},500);c("#swipebox-action").animate({bottom:0},500);setTimeout(function(){r.addClass("visible-bars")},1000)}},hideBars:function(){var r=c("#swipebox-caption, #swipebox-action");if(this.doCssTrans()){r.removeClass("visible-bars")}else{c("#swipebox-caption").animate({top:"-50px"},500);c("#swipebox-action").animate({bottom:"-50px"},500);setTimeout(function(){r.removeClass("visible-bars")},1000)}},animBars:function(){var s=this;var r=c("#swipebox-caption, #swipebox-action");r.addClass("visible-bars");s.setTimeout();c("#swipebox-slider").click(function(t){if(!r.hasClass("visible-bars")){s.showBars();s.setTimeout()}});c("#swipebox-action").hover(function(){s.showBars();r.addClass("force-visible-bars");s.clearTimeout()},function(){r.removeClass("force-visible-bars");s.setTimeout()})},keyboard:function(){var r=this;c(b).bind("keyup",function(s){s.preventDefault();s.stopPropagation();if(s.keyCode==37){r.getPrev()}else{if(s.keyCode==39){r.getNext()}else{if(s.keyCode==27){r.closeSlide()}}}})},actions:function(){var r=this;if(e.length<2){c("#swipebox-prev, #swipebox-next").hide()}else{c("#swipebox-prev").bind("click touchend",function(s){s.preventDefault();s.stopPropagation();r.getPrev();r.setTimeout()});c("#swipebox-next").bind("click touchend",function(s){s.preventDefault();s.stopPropagation();r.getNext();r.setTimeout()})}c("#swipebox-close").bind("click touchend",function(s){r.closeSlide()})},setSlide:function(s,r){r=r||false;var t=c("#swipebox-slider .slide.current").index();var u=c("#swipebox-slider");if(this.doCssTrans()){u.css({left:(-s*100)+"%"})}else{u.animate({left:(-s*100)+"%"})}c("#swipebox-slider .slide").removeClass("current");c("#swipebox-slider .slide").eq(s).addClass("current");if(t>-1&&t<e.length&&e[t].player){e[t].player.pause()}setTimeout(function(){if(e[s].player){if(e[s].player.isready){e[s].player.play()}else{e[s].player.forceplay=true}}},(r?0:600));this.setTitle(s);if(r){u.fadeIn()}c("#swipebox-prev, #swipebox-next").removeClass("disabled");if(s===0){c("#swipebox-prev").addClass("disabled")}else{if(s==e.length-1){c("#swipebox-next").addClass("disabled")}}},openSlide:function(r){c("html").addClass("swipebox");c(b).trigger("resize");c(b).on("message",function(t){var s=JSON.parse(t.originalEvent.data);if(s.event==="ready"){var u=c(".slide:has(#"+s.player_id+")").index();e[u].player.isready=true;if(e[u].player.forceplay){e[u].player.play()}}})},preloadMedia:function(r){var s=this,t=null;if(e[r]!==d){t=e[r].href}setTimeout(function(){s.openMedia(r)},1000)},openMedia:function(r){var t=this,u=null;if(e[r]!==d){u=e[r].href}if(r<0||r>=e.length){return false}if(c("#swipebox-slider .slide").eq(r).html()){return false}if(!t.isVideo(u)){t.loadMedia(u,function(){c("#swipebox-slider .slide").eq(r).html(this)})}else{c("#swipebox-slider .slide").eq(r).html(t.getVideo(u));var s=c("#swipebox-slider .slide").eq(r).find("iframe")[0];if(this.isYoutube(u)){e[r].player=new YT.Player(s,{events:{onReady:function(){e[r].player.isready=true;if(e[r].player.forceplay){e[r].player.play()}}}});e[r].player.play=function(){this.playVideo()};e[r].player.pause=function(){this.pauseVideo()}}else{e[r].player={};e[r].player.play=function(){s.contentWindow.postMessage(JSON.stringify({method:"play"}),s.src)};e[r].player.pause=function(){s.contentWindow.postMessage(JSON.stringify({method:"pause"}),s.src)}}}},setTitle:function(s,r){var t=null;c("#swipebox-caption").empty();if(e[s]!==d){t=e[s].title}if(t){c("#swipebox-caption").append(t)}},isYoutube:function(r){if(r){return(/youtube\.com\/watch\?v=([a-zA-Z0-9\-_]+)/).test(r)}return false},isVimeo:function(r){if(r){return(/vimeo\.com\/([0-9]*)/).test(r)}return false},isVideo:function(r){return this.isYoutube(r)||this.isVimeo(r)},getVideo:function(t){var u="";var s="";var r=t.match(/watch\?v=([a-zA-Z0-9\-_]+)/);var v=t.match(/vimeo\.com\/([0-9]*)/);if(r){u='<iframe width="560" height="315" src="//www.youtube.com/embed/'+r[1]+"?controls=0&amp;showinfo=0&amp;rel=0&amp;version=3&amp;enablejsapi=1&amp;modestbranding=1&amp;origin="+b.location.origin+'" frameborder="0" allowfullscreen></iframe>'}else{if(v){u='<iframe id="i'+v[1]+'" width="560" height="315"  src="//player.vimeo.com/video/'+v[1]+"?color="+n.settings.vimeoColor+"&amp;byline=0&amp;title=0&amp;api=1&amp;player_id=i"+v[1]+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}}return'<div class="swipebox-video-container" style="max-width:'+n.settings.videoMaxWidth+'px"><div class="swipebox-video">'+u+"</div></div>"},loadMedia:function(s,t){if(!this.isVideo(s)){var r=c("<img>").on("load",function(){t.call(r)});r.attr("src",s)}},getNext:function(){index=c("#swipebox-slider .slide.current").index();if(index+1<e.length){index++;this.setSlide(index);this.preloadMedia(index+1)}else{c("#swipebox-slider").addClass("rightSpring");setTimeout(function(){c("#swipebox-slider").removeClass("rightSpring")},500)}},getPrev:function(){index=c("#swipebox-slider .slide.current").index();if(index>0){index--;this.setSlide(index);this.preloadMedia(index-1)}else{c("#swipebox-slider").addClass("leftSpring");setTimeout(function(){c("#swipebox-slider").removeClass("leftSpring")},500)}},closeSlide:function(){c("html").removeClass("swipebox");c(b).trigger("resize");this.destroy()},destroy:function(){c(b).unbind("keyup");c(b).off("message");c("body").unbind("touchstart");c("body").unbind("touchmove");c("body").unbind("touchend");c("#swipebox-slider").unbind();c("#swipebox-overlay").remove();if(!c.isArray(g)){g.removeData("_swipebox")}if(this.target){this.target.trigger("swipebox-destroy")}c.swipebox.isOpen=false;if(n.settings.afterClose){n.settings.afterClose()}}};n.init()};c.fn.swipebox=function(f){if(!c.data(this,"_swipebox")){var e=new c.swipebox(this,f);this.data("_swipebox",e)}return this.data("_swipebox")}}(window,document,jQuery));